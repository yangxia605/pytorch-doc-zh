
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>通过示例学习 PyTorch · Pytorch 中文文档</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="ApacheCN">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-pageview-count/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="53.html" />
    
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    PyTorch 1.4 教程&文档
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    入门
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="4.html">
            
                <a href="4.html">
            
                    
                    使用 PyTorch 进行深度学习：60 分钟的闪电战
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="blitz/tensor_tutorial.html">
            
                <a href="blitz/tensor_tutorial.html">
            
                    
                    什么是PyTorch？
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="blitz/autograd_tutorial.html">
            
                <a href="blitz/autograd_tutorial.html">
            
                    
                    Autograd：自动求导
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="blitz/neural_networks_tutorial.html">
            
                <a href="blitz/neural_networks_tutorial.html">
            
                    
                    神经网络
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="blitz/cifar10_tutorial.html">
            
                <a href="blitz/cifar10_tutorial.html">
            
                    
                    训练分类器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="blitz/data_parallel_tutorial.html">
            
                <a href="blitz/data_parallel_tutorial.html">
            
                    
                    可选：数据并行
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="5.html">
            
                <a href="5.html">
            
                    
                    编写自定义数据集，数据加载器和转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="6.html">
            
                <a href="6.html">
            
                    
                    使用 TensorBoard 可视化模型，数据和训练
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    图片
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="8.html">
            
                <a href="8.html">
            
                    
                    TorchVision 对象检测微调教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="9.html">
            
                <a href="9.html">
            
                    
                    转移学习的计算机视觉教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="10.html">
            
                <a href="10.html">
            
                    
                    空间变压器网络教程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="11.html">
            
                <a href="11.html">
            
                    
                    使用 PyTorch 进行神经传递
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="12.html">
            
                <a href="12.html">
            
                    
                    对抗示例生成
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="13.html">
            
                <a href="13.html">
            
                    
                    DCGAN 教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    音频
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="15.html">
            
                <a href="15.html">
            
                    
                    torchaudio 教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    文本
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="17.html">
            
                <a href="17.html">
            
                    
                    NLP From Scratch: 使用char-RNN对姓氏进行分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="18.html">
            
                <a href="18.html">
            
                    
                    NLP From Scratch: 生成名称与字符级RNN
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="19.html">
            
                <a href="19.html">
            
                    
                    NLP From Scratch: 基于注意力机制的 seq2seq 神经网络翻译
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="20.html">
            
                <a href="20.html">
            
                    
                    使用 TorchText 进行文本分类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="21.html">
            
                <a href="21.html">
            
                    
                    使用 TorchText 进行语言翻译
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="22.html">
            
                <a href="22.html">
            
                    
                    使用 nn.Transformer 和 TorchText 进行序列到序列建模
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    命名为 Tensor(实验性）
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="24.html">
            
                <a href="24.html">
            
                    
                    (实验性）PyTorch 中的命名张量简介
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    强化学习
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="26.html">
            
                <a href="26.html">
            
                    
                    强化学习(DQN）教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    在生产中部署 PyTorch 模型
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="28.html">
            
                <a href="28.html">
            
                    
                    通过带有 Flask 的 REST API 在 Python 中部署 PyTorch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="29.html">
            
                <a href="29.html">
            
                    
                    TorchScript 简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="30.html">
            
                <a href="30.html">
            
                    
                    在 C ++中加载 TorchScript 模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="31.html">
            
                <a href="31.html">
            
                    
                    (可选）将模型从 PyTorch 导出到 ONNX 并使用 ONNX Runtime 运行
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    并行和分布式训练
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="33.html">
            
                <a href="33.html">
            
                    
                    单机模型并行最佳实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="34.html">
            
                <a href="34.html">
            
                    
                    分布式数据并行入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="35.html">
            
                <a href="35.html">
            
                    
                    用 PyTorch 编写分布式应用程序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="36.html">
            
                <a href="36.html">
            
                    
                    分布式 RPC 框架入门
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="37.html">
            
                <a href="37.html">
            
                    
                    (高级）带有 Amazon AWS 的 PyTorch 1.0 分布式训练师
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    扩展 PyTorch
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="39.html">
            
                <a href="39.html">
            
                    
                    使用自定义 C ++运算符扩展 TorchScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="40.html">
            
                <a href="40.html">
            
                    
                    使用自定义 C ++类扩展 TorchScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="41.html">
            
                <a href="41.html">
            
                    
                    使用 numpy 和 scipy 创建扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="42.html">
            
                <a href="42.html">
            
                    
                    自定义 C ++和 CUDA 扩展
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    模型优化
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="44.html">
            
                <a href="44.html">
            
                    
                    LSTM Word 语言模型上的(实验）动态量化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="45.html">
            
                <a href="45.html">
            
                    
                    (实验性）在 PyTorch 中使用 Eager 模式进行静态量化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="46.html">
            
                <a href="46.html">
            
                    
                    (实验性）计算机视觉教程的量化转移学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="47.html">
            
                <a href="47.html">
            
                    
                    (实验）BERT 上的动态量化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="48.html">
            
                <a href="48.html">
            
                    
                    修剪教程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    PyTorch 用其他语言
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="50.html">
            
                <a href="50.html">
            
                    
                    使用 PyTorch C ++前端
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    PyTorch 基础知识
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.13.1" data-path="52.html">
            
                <a href="52.html">
            
                    
                    通过示例学习 PyTorch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="53.html">
            
                <a href="53.html">
            
                    
                    torch.nn 到底是什么？
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    文件
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <span>
            
                    
                    笔记
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="56.html">
            
                <a href="56.html">
            
                    
                    自动毕业力学
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="57.html">
            
                <a href="57.html">
            
                    
                    广播语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="58.html">
            
                <a href="58.html">
            
                    
                    CPU 线程和 TorchScript 推断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="59.html">
            
                <a href="59.html">
            
                    
                    CUDA 语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="60.html">
            
                <a href="60.html">
            
                    
                    分布式 Autograd 设计
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="61.html">
            
                <a href="61.html">
            
                    
                    扩展 PyTorch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="62.html">
            
                <a href="62.html">
            
                    
                    经常问的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="63.html">
            
                <a href="63.html">
            
                    
                    大规模部署的功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.9" data-path="64.html">
            
                <a href="64.html">
            
                    
                    并行处理最佳实践
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.10" data-path="65.html">
            
                <a href="65.html">
            
                    
                    重现性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.11" data-path="66.html">
            
                <a href="66.html">
            
                    
                    远程参考协议
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.12" data-path="67.html">
            
                <a href="67.html">
            
                    
                    序列化语义
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.13" data-path="68.html">
            
                <a href="68.html">
            
                    
                    Windows 常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.14" data-path="69.html">
            
                <a href="69.html">
            
                    
                    XLA 设备上的 PyTorch
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
                <span>
            
                    
                    语言绑定
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="71.html">
            
                <a href="71.html">
            
                    
                    PyTorch C ++ API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="72.html">
            
                <a href="72.html">
            
                    
                    PyTorch Java API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" >
            
                <span>
            
                    
                    Python API
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="74.html">
            
                <a href="74.html">
            
                    
                    torch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.2" data-path="75.html">
            
                <a href="75.html">
            
                    
                    torch.nn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.3" data-path="76.html">
            
                <a href="76.html">
            
                    
                    torch功能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.4" data-path="77.html">
            
                <a href="77.html">
            
                    
                    torch张量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.5" data-path="78.html">
            
                <a href="78.html">
            
                    
                    张量属性
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.6" data-path="79.html">
            
                <a href="79.html">
            
                    
                    自动差分包-Torch.Autograd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.7" data-path="80.html">
            
                <a href="80.html">
            
                    
                    torch.cuda
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.8" data-path="81.html">
            
                <a href="81.html">
            
                    
                    分布式通讯包-Torch.Distributed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.9" data-path="82.html">
            
                <a href="82.html">
            
                    
                    概率分布-torch分布
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.10" data-path="83.html">
            
                <a href="83.html">
            
                    
                    torch.hub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.11" data-path="84.html">
            
                <a href="84.html">
            
                    
                    torch脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.12" data-path="85.html">
            
                <a href="85.html">
            
                    
                    torch.nn.init
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.13" data-path="86.html">
            
                <a href="86.html">
            
                    
                    torch.onnx
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.14" data-path="87.html">
            
                <a href="87.html">
            
                    
                    torch.optim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.15" data-path="88.html">
            
                <a href="88.html">
            
                    
                    量化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.16" data-path="89.html">
            
                <a href="89.html">
            
                    
                    分布式 RPC 框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.17" data-path="90.html">
            
                <a href="90.html">
            
                    
                    torch随机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.18" data-path="91.html">
            
                <a href="91.html">
            
                    
                    torch稀疏
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.19" data-path="92.html">
            
                <a href="92.html">
            
                    
                    torch存储
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.20" data-path="93.html">
            
                <a href="93.html">
            
                    
                    torch.utils.bottleneck
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.21" data-path="94.html">
            
                <a href="94.html">
            
                    
                    torch.utils.checkpoint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.22" data-path="95.html">
            
                <a href="95.html">
            
                    
                    torch.utils.cpp_extension
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.23" data-path="96.html">
            
                <a href="96.html">
            
                    
                    torch.utils.data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.24" data-path="97.html">
            
                <a href="97.html">
            
                    
                    torch.utils.dlpack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.25" data-path="98.html">
            
                <a href="98.html">
            
                    
                    torch.utils.model_zoo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.26" data-path="99.html">
            
                <a href="99.html">
            
                    
                    torch.utils.tensorboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.27" data-path="100.html">
            
                <a href="100.html">
            
                    
                    类型信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.28" data-path="101.html">
            
                <a href="101.html">
            
                    
                    命名张量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.29" data-path="102.html">
            
                <a href="102.html">
            
                    
                    命名为 Tensors 操作员范围
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17.30" data-path="103.html">
            
                <a href="103.html">
            
                    
                    糟糕！
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" >
            
                <span>
            
                    
                    torchvision参考
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="105.html">
            
                <a href="105.html">
            
                    
                    torchvision
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" >
            
                <span>
            
                    
                    音频参考
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="107.html">
            
                <a href="107.html">
            
                    
                    torchaudio
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" >
            
                <span>
            
                    
                    torchtext参考
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="109.html">
            
                <a href="109.html">
            
                    
                    torchtext
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" >
            
                <span>
            
                    
                    社区
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.21.1" data-path="111.html">
            
                <a href="111.html">
            
                    
                    PyTorch 贡献指南
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.2" data-path="112.html">
            
                <a href="112.html">
            
                    
                    PyTorch 治理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.3" data-path="113.html">
            
                <a href="113.html">
            
                    
                    PyTorch 治理| 感兴趣的人
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >通过示例学习 PyTorch</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x901A;&#x8FC7;&#x793A;&#x4F8B;&#x5B66;&#x4E60;-pytorch">&#x901A;&#x8FC7;&#x793A;&#x4F8B;&#x5B66;&#x4E60; PyTorch</h1>
<blockquote>
<p>&#x539F;&#x6587;&#xFF1A; <a href="https://pytorch.org/tutorials/beginner/pytorch_with_examples.html" target="_blank">https://pytorch.org/tutorials/beginner/pytorch_with_examples.html</a></p>
</blockquote>
<p><strong>&#x4F5C;&#x8005;</strong>&#xFF1A;<a href="https://github.com/jcjohnson/pytorch-examples" target="_blank">&#x8D3E;&#x65AF;&#x6C40;&#xB7;&#x7EA6;&#x7FF0;&#x900A;</a></p>
<p>&#x672C;&#x6559;&#x7A0B;&#x901A;&#x8FC7;&#x72EC;&#x7ACB;&#x7684;&#x793A;&#x4F8B;&#x4ECB;&#x7ECD; <a href="https://github.com/pytorch/pytorch" target="_blank">PyTorch</a> &#x7684;&#x57FA;&#x672C;&#x6982;&#x5FF5;&#x3002;</p>
<p>PyTorch &#x7684;&#x6838;&#x5FC3;&#x662F;&#x63D0;&#x4F9B;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x529F;&#x80FD;&#xFF1A;</p>
<ul>
<li>n &#x7EF4;&#x5F20;&#x91CF;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E; numpy&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x5728; GPU &#x4E0A;&#x8FD0;&#x884C;</li>
<li>&#x81EA;&#x52A8;&#x533A;&#x5206;&#x4EE5;&#x6784;&#x5EFA;&#x548C;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</li>
</ul>
<p>&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x5B8C;&#x5168;&#x8FDE;&#x63A5;&#x7684; ReLU &#x7F51;&#x7EDC;&#x4F5C;&#x4E3A;&#x6211;&#x4EEC;&#x7684;&#x8FD0;&#x884C;&#x793A;&#x4F8B;&#x3002; &#x8BE5;&#x7F51;&#x7EDC;&#x5C06;&#x5177;&#x6709;&#x5355;&#x4E2A;&#x9690;&#x85CF;&#x5C42;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x901A;&#x8FC7;&#x6700;&#x5C0F;&#x5316;&#x7F51;&#x7EDC;&#x8F93;&#x51FA;&#x4E0E;&#x771F;&#x5B9E;&#x8F93;&#x51FA;&#x4E4B;&#x95F4;&#x7684;&#x6B27;&#x51E0;&#x91CC;&#x5FB7;&#x8DDD;&#x79BB;&#x6765;&#x8FDB;&#x884C;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x8BAD;&#x7EC3;&#xFF0C;&#x4EE5;&#x9002;&#x5E94;&#x968F;&#x673A;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6CE8;&#x610F;</p>
<p>&#x60A8;&#x53EF;&#x4EE5;&#x5728;&#x672C;&#x9875;&#x7684;&#x672B;&#x5C3E;&#x6D4F;&#x89C8;&#x5404;&#x4E2A;&#x793A;&#x4F8B;&#x3002;</p>
<p>&#x76EE;&#x5F55;</p>
<ul>
<li><a href="#tensors">&#x5F20;&#x91CF;</a><ul>
<li><a href="#warm-up-numpy">Warm-up&#xFF1A;numpy</a></li>
<li><a href="#pytorch-tensors">PyTorch&#xFF1A;&#x5F20;&#x91CF;</a></li>
</ul>
</li>
<li><a href="#autograd">&#x81EA;&#x52A8;&#x5206;&#x7EA7;</a><ul>
<li><a href="#pytorch-tensors-and-autograd">PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;&#x81EA;&#x5B9A;&#x7B49;&#x7EA7;</a></li>
<li><a href="#pytorch-defining-new-autograd-functions">PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;&#x7684; autograd &#x529F;&#x80FD;</a></li>
</ul>
</li>
<li><a href="#nn-module">&lt;cite&gt;nn&lt;/cite&gt; &#x6A21;&#x5757;</a><ul>
<li><a href="#pytorch-nn">PyTorch&#xFF1A;nn</a></li>
<li><a href="#pytorch-optim">PyTorch&#xFF1A;&#x4F18;&#x5316;</a></li>
<li><a href="#pytorch-custom-nn-modules">PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49; nn &#x6A21;&#x5757;</a></li>
<li><a href="#pytorch-control-flow-weight-sharing">PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x6743;&#x91CD;&#x5171;&#x4EAB;</a></li>
</ul>
</li>
<li><a href="#examples">&#x8303;&#x4F8B;</a><ul>
<li><a href="#id1">&#x5F20;&#x91CF;</a></li>
<li><a href="#id2">&#x81EA;&#x52A8;&#x5206;&#x7EA7;</a></li>
<li><a href="#id3">&lt;cite&gt;nn&lt;/cite&gt; &#x6A21;&#x5757;</a></li>
</ul>
</li>
</ul>
<h2 id="&#x5F20;&#x91CF;"><a href="#id13">&#x5F20;&#x91CF;</a></h2>
<h3 id="warm-up&#xFF1A;numpy"><a href="#id14">Warm-up&#xFF1A;numpy</a></h3>
<p>&#x5728;&#x4ECB;&#x7ECD; PyTorch &#x4E4B;&#x524D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x9996;&#x5148;&#x4F7F;&#x7528; numpy &#x5B9E;&#x73B0;&#x7F51;&#x7EDC;&#x3002;</p>
<p>Numpy &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A; n &#x7EF4;&#x6570;&#x7EC4;&#x5BF9;&#x8C61;&#xFF0C;&#x4EE5;&#x53CA;&#x8BB8;&#x591A;&#x7528;&#x4E8E;&#x64CD;&#x7EB5;&#x8FD9;&#x4E9B;&#x6570;&#x7EC4;&#x7684;&#x51FD;&#x6570;&#x3002; Numpy &#x662F;&#x7528;&#x4E8E;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x7684;&#x901A;&#x7528;&#x6846;&#x67B6;&#x3002; &#x5B83;&#x5BF9;&#x8BA1;&#x7B97;&#x56FE;&#xFF0C;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6216;&#x68AF;&#x5EA6;&#x4E00;&#x65E0;&#x6240;&#x77E5;&#x3002; &#x4F46;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; numpy &#x64CD;&#x4F5C;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x7684;&#x524D;&#x5411;&#x548C;&#x540E;&#x5411;&#x4F20;&#x9012;&#xFF0C;&#x4ECE;&#x800C;&#x8F7B;&#x677E;&#x5730;&#x4F7F;&#x7528; numpy &#x4F7F;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x9002;&#x5408;&#x968F;&#x673A;&#x6570;&#x636E;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import numpy as np

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random input and output data
x = np.random.randn(N, D_in)
y = np.random.randn(N, D_out)

# Randomly initialize weights
w1 = np.random.randn(D_in, H)
w2 = np.random.randn(H, D_out)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y
    h = x.dot(w1)
    h_relu = np.maximum(h, 0)
    y_pred = h_relu.dot(w2)

    # Compute and print loss
    loss = np.square(y_pred - y).sum()
    print(t, loss)

    # Backprop to compute gradients of w1 and w2 with respect to loss
    grad_y_pred = 2.0 * (y_pred - y)
    grad_w2 = h_relu.T.dot(grad_y_pred)
    grad_h_relu = grad_y_pred.dot(w2.T)
    grad_h = grad_h_relu.copy()
    grad_h[h &lt; 0] = 0
    grad_w1 = x.T.dot(grad_h)

    # Update weights
    w1 -= learning_rate * grad_w1
    w2 -= learning_rate * grad_w2
</code></pre><h3 id="pytorch&#xFF1A;&#x5F20;&#x91CF;"><a href="#id15">PyTorch&#xFF1A;&#x5F20;&#x91CF;</a></h3>
<p>Numpy &#x662F;&#x4E00;&#x4E2A;&#x5F88;&#x68D2;&#x7684;&#x6846;&#x67B6;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4E0D;&#x80FD;&#x5229;&#x7528; GPU &#x6765;&#x52A0;&#x901F;&#x5176;&#x6570;&#x503C;&#x8BA1;&#x7B97;&#x3002; &#x5BF9;&#x4E8E;&#x73B0;&#x4EE3;&#x6DF1;&#x5EA6;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;GPU &#x901A;&#x5E38;&#x4F1A;&#x63D0;&#x4F9B; <a href="https://github.com/jcjohnson/cnn-benchmarks" target="_blank">50 &#x500D;&#x6216;&#x66F4;&#x9AD8;</a>&#x7684;&#x52A0;&#x901F;&#xFF0C;&#x56E0;&#x6B64;&#x9057;&#x61BE;&#x7684;&#x662F;&#xFF0C;numpy &#x4E0D;&#x8DB3;&#x4EE5;&#x5B9E;&#x73B0;&#x73B0;&#x4EE3;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x6700;&#x57FA;&#x672C;&#x7684; PyTorch &#x6982;&#x5FF5;&#xFF1A;<strong>&#x5F20;&#x91CF;</strong>&#x3002; PyTorch &#x5F20;&#x91CF;&#x5728;&#x6982;&#x5FF5;&#x4E0A;&#x4E0E; numpy &#x6570;&#x7EC4;&#x76F8;&#x540C;&#xFF1A;&#x5F20;&#x91CF;&#x662F; n &#x7EF4;&#x6570;&#x7EC4;&#xFF0C;&#x800C; PyTorch &#x63D0;&#x4F9B;&#x4E86;&#x8BB8;&#x591A;&#x5728;&#x8FD9;&#x4E9B;&#x5F20;&#x91CF;&#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x529F;&#x80FD;&#x3002; &#x5728;&#x5E55;&#x540E;&#xFF0C;&#x5F20;&#x91CF;&#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;&#x8BA1;&#x7B97;&#x56FE;&#x548C;&#x6E10;&#x53D8;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x4E5F;&#x53EF;&#x7528;&#x4F5C;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x7684;&#x901A;&#x7528;&#x5DE5;&#x5177;&#x3002;</p>
<p>&#x4E0E; numpy &#x4E0D;&#x540C;&#xFF0C;PyTorch &#x5F20;&#x91CF;&#x53EF;&#x4EE5;&#x5229;&#x7528; GPU &#x52A0;&#x901F;&#x5176;&#x6570;&#x5B57;&#x8BA1;&#x7B97;&#x3002; &#x8981;&#x5728; GPU &#x4E0A;&#x8FD0;&#x884C; PyTorch Tensor&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5C06;&#x5176;&#x8F6C;&#x6362;&#x4E3A;&#x65B0;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; PyTorch &#x5F20;&#x91CF;&#x4F7F;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x9002;&#x5408;&#x968F;&#x673A;&#x6570;&#x636E;&#x3002; &#x50CF;&#x4E0A;&#x9762;&#x7684; numpy &#x793A;&#x4F8B;&#x4E00;&#x6837;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x7684;&#x6B63;&#x5411;&#x548C;&#x53CD;&#x5411;&#x4F20;&#x9012;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-

import torch

dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random input and output data
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Randomly initialize weights
w1 = torch.randn(D_in, H, device=device, dtype=dtype)
w2 = torch.randn(H, D_out, device=device, dtype=dtype)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y
    h = x.mm(w1)
    h_relu = h.clamp(min=0)
    y_pred = h_relu.mm(w2)

    # Compute and print loss
    loss = (y_pred - y).pow(2).sum().item()
    if t % 100 == 99:
        print(t, loss)

    # Backprop to compute gradients of w1 and w2 with respect to loss
    grad_y_pred = 2.0 * (y_pred - y)
    grad_w2 = h_relu.t().mm(grad_y_pred)
    grad_h_relu = grad_y_pred.mm(w2.t())
    grad_h = grad_h_relu.clone()
    grad_h[h &lt; 0] = 0
    grad_w1 = x.t().mm(grad_h)

    # Update weights using gradient descent
    w1 -= learning_rate * grad_w1
    w2 -= learning_rate * grad_w2
</code></pre><h2 id="&#x81EA;&#x52A8;&#x5206;&#x7EA7;"><a href="#id16">&#x81EA;&#x52A8;&#x5206;&#x7EA7;</a></h2>
<h3 id="pytorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;&#x81EA;&#x5B9A;&#x7B49;&#x7EA7;"><a href="#id17">PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;&#x81EA;&#x5B9A;&#x7B49;&#x7EA7;</a></h3>
<p>&#x5728;&#x4EE5;&#x4E0A;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5FC5;&#x987B;&#x624B;&#x52A8;&#x5B9E;&#x73B0;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6B63;&#x5411;&#x548C;&#x53CD;&#x5411;&#x4F20;&#x9012;&#x3002; &#x5BF9;&#x4E8E;&#x5C0F;&#x578B;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#xFF0C;&#x624B;&#x52A8;&#x5B9E;&#x65BD;&#x53CD;&#x5411;&#x4F20;&#x9012;&#x5E76;&#x4E0D;&#x662F;&#x4EC0;&#x4E48;&#x5927;&#x95EE;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x5927;&#x578B;&#x7684;&#x590D;&#x6742;&#x7F51;&#x7EDC;&#x800C;&#x8A00;&#xFF0C;&#x53EF;&#x4EE5;&#x5F88;&#x5FEB;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x9EBB;&#x70E6;&#x3002;</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a href="https://en.wikipedia.org/wiki/Automatic_differentiation" target="_blank">&#x81EA;&#x52A8;&#x5FAE;&#x5206;</a>&#x6765;&#x81EA;&#x52A8;&#x8BA1;&#x7B97;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x53CD;&#x5411;&#x4F20;&#x9012;&#x3002; PyTorch &#x4E2D;&#x7684; <strong>autograd</strong> &#x8F6F;&#x4EF6;&#x5305;&#x6B63;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x6B64;&#x529F;&#x80FD;&#x3002; &#x4F7F;&#x7528; autograd &#x65F6;&#xFF0C;&#x7F51;&#x7EDC;&#x7684;&#x6B63;&#x5411;&#x4F20;&#x9012;&#x5C06;&#x5B9A;&#x4E49;<strong>&#x8BA1;&#x7B97;&#x56FE;</strong>&#xFF1B; &#x56FE;&#x4E2D;&#x7684;&#x8282;&#x70B9;&#x4E3A;&#x5F20;&#x91CF;&#xFF0C;&#x8FB9;&#x4E3A;&#x4ECE;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x751F;&#x6210;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x7684;&#x51FD;&#x6570;&#x3002; &#x7136;&#x540E;&#x901A;&#x8FC7;&#x8BE5;&#x56FE;&#x8FDB;&#x884C;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#xFF0C;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x8BA1;&#x7B97;&#x68AF;&#x5EA6;&#x3002;</p>
<p>&#x8FD9;&#x542C;&#x8D77;&#x6765;&#x5F88;&#x590D;&#x6742;&#xFF0C;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x3002; &#x6BCF;&#x4E2A;&#x5F20;&#x91CF;&#x4EE3;&#x8868;&#x8BA1;&#x7B97;&#x56FE;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x3002; &#x5982;&#x679C;<code>x</code>&#x662F;&#x5177;&#x6709;<code>x.requires_grad=True</code>&#x7684;&#x5F20;&#x91CF;&#xFF0C;&#x5219;<code>x.grad</code>&#x662F;&#x53E6;&#x4E00;&#x4E2A;&#x5F20;&#x91CF;&#xFF0C;&#x5176;&#x4FDD;&#x6301;<code>x</code>&#x76F8;&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x6807;&#x91CF;&#x503C;&#x7684;&#x68AF;&#x5EA6;&#x3002;</p>
<p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528; PyTorch &#x5F20;&#x91CF;&#x548C; autograd &#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x3002; &#x73B0;&#x5728;&#x6211;&#x4EEC;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x624B;&#x52A8;&#x901A;&#x8FC7;&#x7F51;&#x7EDC;&#x5B9E;&#x73B0;&#x53CD;&#x5411;&#x4F20;&#x9012;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold input and outputs.
# Setting requires_grad=False indicates that we do not need to compute gradients
# with respect to these Tensors during the backward pass.
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Create random Tensors for weights.
# Setting requires_grad=True indicates that we want to compute gradients with
# respect to these Tensors during the backward pass.
w1 = torch.randn(D_in, H, device=device, dtype=dtype, requires_grad=True)
w2 = torch.randn(H, D_out, device=device, dtype=dtype, requires_grad=True)

learning_rate = 1e-6
for t in range(500):
    # Forward pass: compute predicted y using operations on Tensors; these
    # are exactly the same operations we used to compute the forward pass using
    # Tensors, but we do not need to keep references to intermediate values since
    # we are not implementing the backward pass by hand.
    y_pred = x.mm(w1).clamp(min=0).mm(w2)

    # Compute and print loss using operations on Tensors.
    # Now loss is a Tensor of shape (1,)
    # loss.item() gets the scalar value held in the loss.
    loss = (y_pred - y).pow(2).sum()
    if t % 100 == 99:
        print(t, loss.item())

    # Use autograd to compute the backward pass. This call will compute the
    # gradient of loss with respect to all Tensors with requires_grad=True.
    # After this call w1.grad and w2.grad will be Tensors holding the gradient
    # of the loss with respect to w1 and w2 respectively.
    loss.backward()

    # Manually update weights using gradient descent. Wrap in torch.no_grad()
    # because weights have requires_grad=True, but we don&apos;t need to track this
    # in autograd.
    # An alternative way is to operate on weight.data and weight.grad.data.
    # Recall that tensor.data gives a tensor that shares the storage with
    # tensor, but doesn&apos;t track history.
    # You can also use torch.optim.SGD to achieve this.
    with torch.no_grad():
        w1 -= learning_rate * w1.grad
        w2 -= learning_rate * w2.grad

        # Manually zero the gradients after updating weights
        w1.grad.zero_()
        w2.grad.zero_()
</code></pre><h3 id="pytorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;&#x7684;-autograd-&#x529F;&#x80FD;"><a href="#id18">PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;&#x7684; autograd &#x529F;&#x80FD;</a></h3>
<p>&#x5728;&#x5E55;&#x540E;&#xFF0C;&#x6BCF;&#x4E2A;&#x539F;&#x59CB;&#x7684; autograd &#x8FD0;&#x7B97;&#x7B26;&#x5B9E;&#x9645;&#x4E0A;&#x90FD;&#x662F;&#x5728; Tensor &#x4E0A;&#x8FD0;&#x884C;&#x7684;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x3002; <strong>&#x6B63;&#x5411;</strong>&#x51FD;&#x6570;&#x4ECE;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x8BA1;&#x7B97;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x3002; <strong>&#x5411;&#x540E;</strong>&#x51FD;&#x6570;&#x63A5;&#x6536;&#x76F8;&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x6807;&#x91CF;&#x503C;&#x7684;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#x7684;&#x68AF;&#x5EA6;&#xFF0C;&#x5E76;&#x8BA1;&#x7B97;&#x76F8;&#x5BF9;&#x4E8E;&#x76F8;&#x540C;&#x6807;&#x91CF;&#x503C;&#x7684;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x7684;&#x68AF;&#x5EA6;&#x3002;</p>
<p>&#x5728; PyTorch &#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B9A;&#x4E49;<code>torch.autograd.Function</code>&#x7684;&#x5B50;&#x7C7B;&#x5E76;&#x5B9E;&#x73B0;<code>forward</code>&#x548C;<code>backward</code>&#x51FD;&#x6570;&#x6765;&#x8F7B;&#x677E;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684; autograd &#x8FD0;&#x7B97;&#x7B26;&#x3002; &#x7136;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6784;&#x9020;&#x5B9E;&#x4F8B;&#x5E76;&#x50CF;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x4E00;&#x6837;&#x8C03;&#x7528;&#x65B0;&#x7684; autograd &#x8FD0;&#x7B97;&#x7B26;&#xFF0C;&#x5E76;&#x4F20;&#x9012;&#x5305;&#x542B;&#x8F93;&#x5165;&#x6570;&#x636E;&#x7684;&#x5F20;&#x91CF;&#x3002;</p>
<p>&#x5728;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;&#x4E86;&#x81EA;&#x5DF1;&#x7684;&#x81EA;&#x5B9A;&#x4E49; autograd &#x51FD;&#x6570;&#x6765;&#x6267;&#x884C; ReLU &#x975E;&#x7EBF;&#x6027;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x5B83;&#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

class MyReLU(torch.autograd.Function):
    &quot;&quot;&quot;
    We can implement our own custom autograd Functions by subclassing
    torch.autograd.Function and implementing the forward and backward passes
    which operate on Tensors.
    &quot;&quot;&quot;

    @staticmethod
    def forward(ctx, input):
        &quot;&quot;&quot;
        In the forward pass we receive a Tensor containing the input and return
        a Tensor containing the output. ctx is a context object that can be used
        to stash information for backward computation. You can cache arbitrary
        objects for use in the backward pass using the ctx.save_for_backward method.
        &quot;&quot;&quot;
        ctx.save_for_backward(input)
        return input.clamp(min=0)

    @staticmethod
    def backward(ctx, grad_output):
        &quot;&quot;&quot;
        In the backward pass we receive a Tensor containing the gradient of the loss
        with respect to the output, and we need to compute the gradient of the loss
        with respect to the input.
        &quot;&quot;&quot;
        input, = ctx.saved_tensors
        grad_input = grad_output.clone()
        grad_input[input &lt; 0] = 0
        return grad_input

dtype = torch.float
device = torch.device(&quot;cpu&quot;)
# device = torch.device(&quot;cuda:0&quot;) # Uncomment this to run on GPU

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold input and outputs.
x = torch.randn(N, D_in, device=device, dtype=dtype)
y = torch.randn(N, D_out, device=device, dtype=dtype)

# Create random Tensors for weights.
w1 = torch.randn(D_in, H, device=device, dtype=dtype, requires_grad=True)
w2 = torch.randn(H, D_out, device=device, dtype=dtype, requires_grad=True)

learning_rate = 1e-6
for t in range(500):
    # To apply our Function, we use Function.apply method. We alias this as &apos;relu&apos;.
    relu = MyReLU.apply

    # Forward pass: compute predicted y using operations; we compute
    # ReLU using our custom autograd operation.
    y_pred = relu(x.mm(w1)).mm(w2)

    # Compute and print loss
    loss = (y_pred - y).pow(2).sum()
    if t % 100 == 99:
        print(t, loss.item())

    # Use autograd to compute the backward pass.
    loss.backward()

    # Update weights using gradient descent
    with torch.no_grad():
        w1 -= learning_rate * w1.grad
        w2 -= learning_rate * w2.grad

        # Manually zero the gradients after updating weights
        w1.grad.zero_()
        w2.grad.zero_()
</code></pre><h2 id="citenncite-&#x6A21;&#x5757;"><a href="#id19">&lt;cite&gt;nn&lt;/cite&gt; &#x6A21;&#x5757;</a></h2>
<h3 id="pytorch&#xFF1A;nn"><a href="#id20">PyTorch&#xFF1A;nn</a></h3>
<p>&#x8BA1;&#x7B97;&#x56FE;&#x548C; autograd &#x662F;&#x5B9A;&#x4E49;&#x590D;&#x6742;&#x8FD0;&#x7B97;&#x7B26;&#x5E76;&#x81EA;&#x52A8;&#x91C7;&#x7528;&#x5BFC;&#x6570;&#x7684;&#x975E;&#x5E38;&#x5F3A;&#x5927;&#x7684;&#x8303;&#x4F8B;&#x3002; &#x4F46;&#x662F;&#x5BF9;&#x4E8E;&#x5927;&#x578B;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x539F;&#x59CB;&#x7684; autograd &#x53EF;&#x80FD;&#x4F1A;&#x6709;&#x70B9;&#x592A;&#x4F4E;&#x4E86;&#x3002;</p>
<p>&#x5728;&#x6784;&#x5EFA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x60F3;&#x5230;&#x5C06;&#x8BA1;&#x7B97;&#x5B89;&#x6392;&#x5728;<strong>&#x5C42;</strong>&#x4E2D;&#xFF0C;&#x5176;&#x4E2D;&#x67D0;&#x4E9B;&#x5C42;&#x5177;&#x6709;<strong>&#x53EF;&#x5B66;&#x4E60;&#x7684;&#x53C2;&#x6570;</strong>&#xFF0C;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x5C06;&#x5728;&#x5B66;&#x4E60;&#x671F;&#x95F4;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x3002;</p>
<p>&#x5728; TensorFlow &#x4E2D;&#xFF0C;&#x50CF; <a href="https://github.com/fchollet/keras" target="_blank">Keras</a> &#xFF0C; <a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/slim" target="_blank">TensorFlow-Slim</a> &#x548C; <a href="http://tflearn.org/" target="_blank">TFLearn</a> &#x4E4B;&#x7C7B;&#x7684;&#x8F6F;&#x4EF6;&#x5305;&#x5728;&#x539F;&#x59CB;&#x8BA1;&#x7B97;&#x56FE;&#x4E0A;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x9AD8;&#x5C42;&#x6B21;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3002;</p>
<p>&#x5728; PyTorch &#x4E2D;&#xFF0C;<code>nn</code>&#x5305;&#x4E5F;&#x8FBE;&#x5230;&#x4E86;&#x76F8;&#x540C;&#x7684;&#x76EE;&#x7684;&#x3002; <code>nn</code>&#x5305;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7EC4;<strong>&#x6A21;&#x5757;</strong>&#xFF0C;&#x5B83;&#x4EEC;&#x5927;&#x81F4;&#x7B49;&#x6548;&#x4E8E;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5C42;&#x3002; &#x6A21;&#x5757;&#x63A5;&#x6536;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x5E76;&#x8BA1;&#x7B97;&#x8F93;&#x51FA;&#x5F20;&#x91CF;&#xFF0C;&#x4F46;&#x4E5F;&#x53EF;&#x4EE5;&#x4FDD;&#x6301;&#x5185;&#x90E8;&#x72B6;&#x6001;&#xFF0C;&#x4F8B;&#x5982;&#x5305;&#x542B;&#x53EF;&#x5B66;&#x4E60;&#x53C2;&#x6570;&#x7684;&#x5F20;&#x91CF;&#x3002; <code>nn</code>&#x7A0B;&#x5E8F;&#x5305;&#x8FD8;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x7EC4;&#x6709;&#x7528;&#x7684;&#x635F;&#x5931;&#x51FD;&#x6570;&#xFF0C;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x901A;&#x5E38;&#x5728;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x65F6;&#x4F7F;&#x7528;&#x3002;</p>
<p>&#x5728;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>nn</code>&#x5305;&#x6765;&#x5B9E;&#x73B0;&#x6211;&#x4EEC;&#x7684;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Use the nn package to define our model as a sequence of layers. nn.Sequential
# is a Module which contains other Modules, and applies them in sequence to
# produce its output. Each Linear Module computes output from input using a
# linear function, and holds internal Tensors for its weight and bias.
model = torch.nn.Sequential(
    torch.nn.Linear(D_in, H),
    torch.nn.ReLU(),
    torch.nn.Linear(H, D_out),
)

# The nn package also contains definitions of popular loss functions; in this
# case we will use Mean Squared Error (MSE) as our loss function.
loss_fn = torch.nn.MSELoss(reduction=&apos;sum&apos;)

learning_rate = 1e-4
for t in range(500):
    # Forward pass: compute predicted y by passing x to the model. Module objects
    # override the __call__ operator so you can call them like functions. When
    # doing so you pass a Tensor of input data to the Module and it produces
    # a Tensor of output data.
    y_pred = model(x)

    # Compute and print loss. We pass Tensors containing the predicted and true
    # values of y, and the loss function returns a Tensor containing the
    # loss.
    loss = loss_fn(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero the gradients before running the backward pass.
    model.zero_grad()

    # Backward pass: compute gradient of the loss with respect to all the learnable
    # parameters of the model. Internally, the parameters of each Module are stored
    # in Tensors with requires_grad=True, so this call will compute gradients for
    # all learnable parameters in the model.
    loss.backward()

    # Update the weights using gradient descent. Each parameter is a Tensor, so
    # we can access its gradients like we did before.
    with torch.no_grad():
        for param in model.parameters():
            param -= learning_rate * param.grad
</code></pre><h3 id="pytorch&#xFF1A;&#x4F18;&#x5316;"><a href="#id21">PyTorch&#xFF1A;&#x4F18;&#x5316;</a></h3>
<p>&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x624B;&#x52A8;&#x66F4;&#x6539;&#x6301;&#x6709;&#x53EF;&#x5B66;&#x4E60;&#x53C2;&#x6570;&#x7684;&#x5F20;&#x91CF;(&#x4F7F;&#x7528;<code>torch.no_grad()</code>&#x6216;<code>.data</code>&#x6765;&#x907F;&#x514D;&#x5728;&#x81EA;&#x52A8;&#x5206;&#x7EA7;&#x4E2D;&#x8DDF;&#x8E2A;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#xFF09;&#x6765;&#x66F4;&#x65B0;&#x6A21;&#x578B;&#x7684;&#x6743;&#x91CD;&#x3002; &#x5BF9;&#x4E8E;&#x50CF;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x8FD9;&#x6837;&#x7684;&#x7B80;&#x5355;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x800C;&#x8A00;&#xFF0C;&#x8FD9;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5DE8;&#x5927;&#x7684;&#x8D1F;&#x62C5;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x7ECF;&#x5E38;&#x4F7F;&#x7528;&#x66F4;&#x590D;&#x6742;&#x7684;&#x4F18;&#x5316;&#x5668;(&#x4F8B;&#x5982; AdaGrad&#xFF0C;RMSProp&#xFF0C;Adam &#x7B49;&#xFF09;&#x6765;&#x8BAD;&#x7EC3;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3002;</p>
<p>PyTorch &#x4E2D;&#x7684;<code>optim</code>&#x8F6F;&#x4EF6;&#x5305;&#x62BD;&#x8C61;&#x4E86;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x7684;&#x601D;&#x60F3;&#xFF0C;&#x5E76;&#x63D0;&#x4F9B;&#x4E86;&#x5E38;&#x7528;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>&#x5728;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;<code>nn</code>&#x5305;&#x50CF;&#x4EE5;&#x524D;&#x4E00;&#x6837;&#x5B9A;&#x4E49;&#x6211;&#x4EEC;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;<code>optim</code>&#x5305;&#x63D0;&#x4F9B;&#x7684; Adam &#x7B97;&#x6CD5;&#x4F18;&#x5316;&#x6A21;&#x578B;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Use the nn package to define our model and loss function.
model = torch.nn.Sequential(
    torch.nn.Linear(D_in, H),
    torch.nn.ReLU(),
    torch.nn.Linear(H, D_out),
)
loss_fn = torch.nn.MSELoss(reduction=&apos;sum&apos;)

# Use the optim package to define an Optimizer that will update the weights of
# the model for us. Here we will use Adam; the optim package contains many other
# optimization algoriths. The first argument to the Adam constructor tells the
# optimizer which Tensors it should update.
learning_rate = 1e-4
optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate)
for t in range(500):
    # Forward pass: compute predicted y by passing x to the model.
    y_pred = model(x)

    # Compute and print loss.
    loss = loss_fn(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Before the backward pass, use the optimizer object to zero all of the
    # gradients for the variables it will update (which are the learnable
    # weights of the model). This is because by default, gradients are
    # accumulated in buffers( i.e, not overwritten) whenever .backward()
    # is called. Checkout docs of torch.autograd.backward for more details.
    optimizer.zero_grad()

    # Backward pass: compute gradient of the loss with respect to model
    # parameters
    loss.backward()

    # Calling the step function on an Optimizer makes an update to its
    # parameters
    optimizer.step()
</code></pre><h3 id="pytorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49;-nn-&#x6A21;&#x5757;"><a href="#id22">PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49; nn &#x6A21;&#x5757;</a></h3>
<p>&#x6709;&#x65F6;&#xFF0C;&#x60A8;&#x5C06;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x6BD4;&#x4E00;&#x7CFB;&#x5217;&#x73B0;&#x6709;&#x6A21;&#x5757;&#x66F4;&#x590D;&#x6742;&#x7684;&#x6A21;&#x578B;&#x3002; &#x5BF9;&#x4E8E;&#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5B50;&#x7C7B;&#x5316;<code>nn.Module</code>&#x5E76;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<code>forward</code>&#x6765;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x6A21;&#x5757;&#xFF0C;&#x8BE5;&#x6A21;&#x5757;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x6A21;&#x5757;&#x6216;&#x5728; Tensors &#x4E0A;&#x7684;&#x5176;&#x4ED6;&#x81EA;&#x52A8;&#x8F6C;&#x6362;&#x64CD;&#x4F5C;&#x6765;&#x63A5;&#x6536;&#x8F93;&#x5165; Tensors &#x5E76;&#x751F;&#x6210;&#x8F93;&#x51FA; Tensors&#x3002;</p>
<p>&#x5728;&#x6B64;&#x793A;&#x4F8B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4E24;&#x5C42;&#x7F51;&#x7EDC;&#x5B9E;&#x73B0;&#x4E3A;&#x81EA;&#x5B9A;&#x4E49;&#x7684; Module &#x5B50;&#x7C7B;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import torch

class TwoLayerNet(torch.nn.Module):
    def __init__(self, D_in, H, D_out):
        &quot;&quot;&quot;
        In the constructor we instantiate two nn.Linear modules and assign them as
        member variables.
        &quot;&quot;&quot;
        super(TwoLayerNet, self).__init__()
        self.linear1 = torch.nn.Linear(D_in, H)
        self.linear2 = torch.nn.Linear(H, D_out)

    def forward(self, x):
        &quot;&quot;&quot;
        In the forward function we accept a Tensor of input data and we must return
        a Tensor of output data. We can use Modules defined in the constructor as
        well as arbitrary operators on Tensors.
        &quot;&quot;&quot;
        h_relu = self.linear1(x).clamp(min=0)
        y_pred = self.linear2(h_relu)
        return y_pred

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Construct our model by instantiating the class defined above
model = TwoLayerNet(D_in, H, D_out)

# Construct our loss function and an Optimizer. The call to model.parameters()
# in the SGD constructor will contain the learnable parameters of the two
# nn.Linear modules which are members of the model.
criterion = torch.nn.MSELoss(reduction=&apos;sum&apos;)
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4)
for t in range(500):
    # Forward pass: Compute predicted y by passing x to the model
    y_pred = model(x)

    # Compute and print loss
    loss = criterion(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero gradients, perform a backward pass, and update the weights.
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
</code></pre><h3 id="pytorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;&#x6743;&#x91CD;&#x5171;&#x4EAB;"><a href="#id23">PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x6743;&#x91CD;&#x5171;&#x4EAB;</a></h3>
<p>&#x4F5C;&#x4E3A;&#x52A8;&#x6001;&#x56FE;&#x548C;&#x6743;&#x91CD;&#x5171;&#x4EAB;&#x7684;&#x793A;&#x4F8B;&#xFF0C;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x5947;&#x602A;&#x7684;&#x6A21;&#x578B;&#xFF1A;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x8FDE;&#x63A5;&#x7684; ReLU &#x7F51;&#x7EDC;&#xFF0C;&#x8BE5;&#x7F51;&#x7EDC;&#x5728;&#x6BCF;&#x4E2A;&#x524D;&#x5411;&#x4F20;&#x9012;&#x4E2D;&#x9009;&#x62E9; 1 &#x5230; 4 &#x4E4B;&#x95F4;&#x7684;&#x968F;&#x673A;&#x6570;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x90A3;&#x4E48;&#x591A;&#x9690;&#x85CF;&#x5C42;&#xFF0C;&#x591A;&#x6B21;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6743;&#x91CD; &#x8BA1;&#x7B97;&#x6700;&#x91CC;&#x9762;&#x7684;&#x9690;&#x85CF;&#x5C42;&#x3002;</p>
<p>&#x5BF9;&#x4E8E;&#x6B64;&#x6A21;&#x578B;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5E38;&#x89C4;&#x7684; Python &#x6D41;&#x63A7;&#x5236;&#x6765;&#x5B9E;&#x73B0;&#x5FAA;&#x73AF;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x5B9A;&#x4E49;&#x524D;&#x5411;&#x4F20;&#x9012;&#x65F6;&#x7B80;&#x5355;&#x5730;&#x591A;&#x6B21;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x6A21;&#x5757;&#x6765;&#x5B9E;&#x73B0;&#x6700;&#x5185;&#x5C42;&#x4E4B;&#x95F4;&#x7684;&#x6743;&#x91CD;&#x5171;&#x4EAB;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8F7B;&#x677E;&#x5730;&#x5C06;&#x6B64;&#x6A21;&#x578B;&#x5B9E;&#x73B0;&#x4E3A; Module &#x5B50;&#x7C7B;&#xFF1A;</p>
<pre><code># -*- coding: utf-8 -*-
import random
import torch

class DynamicNet(torch.nn.Module):
    def __init__(self, D_in, H, D_out):
        &quot;&quot;&quot;
        In the constructor we construct three nn.Linear instances that we will use
        in the forward pass.
        &quot;&quot;&quot;
        super(DynamicNet, self).__init__()
        self.input_linear = torch.nn.Linear(D_in, H)
        self.middle_linear = torch.nn.Linear(H, H)
        self.output_linear = torch.nn.Linear(H, D_out)

    def forward(self, x):
        &quot;&quot;&quot;
        For the forward pass of the model, we randomly choose either 0, 1, 2, or 3
        and reuse the middle_linear Module that many times to compute hidden layer
        representations.

        Since each forward pass builds a dynamic computation graph, we can use normal
        Python control-flow operators like loops or conditional statements when
        defining the forward pass of the model.

        Here we also see that it is perfectly safe to reuse the same Module many
        times when defining a computational graph. This is a big improvement from Lua
        Torch, where each Module could be used only once.
        &quot;&quot;&quot;
        h_relu = self.input_linear(x).clamp(min=0)
        for _ in range(random.randint(0, 3)):
            h_relu = self.middle_linear(h_relu).clamp(min=0)
        y_pred = self.output_linear(h_relu)
        return y_pred

# N is batch size; D_in is input dimension;
# H is hidden dimension; D_out is output dimension.
N, D_in, H, D_out = 64, 1000, 100, 10

# Create random Tensors to hold inputs and outputs
x = torch.randn(N, D_in)
y = torch.randn(N, D_out)

# Construct our model by instantiating the class defined above
model = DynamicNet(D_in, H, D_out)

# Construct our loss function and an Optimizer. Training this strange model with
# vanilla stochastic gradient descent is tough, so we use momentum
criterion = torch.nn.MSELoss(reduction=&apos;sum&apos;)
optimizer = torch.optim.SGD(model.parameters(), lr=1e-4, momentum=0.9)
for t in range(500):
    # Forward pass: Compute predicted y by passing x to the model
    y_pred = model(x)

    # Compute and print loss
    loss = criterion(y_pred, y)
    if t % 100 == 99:
        print(t, loss.item())

    # Zero gradients, perform a backward pass, and update the weights.
    optimizer.zero_grad()
    loss.backward()
    optimizer.step()
</code></pre><h2 id="&#x8303;&#x4F8B;"><a href="#id24">&#x8303;&#x4F8B;</a></h2>
<p>&#x60A8;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x5904;&#x6D4F;&#x89C8;&#x4EE5;&#x4E0A;&#x793A;&#x4F8B;&#x3002;</p>
<h3 id="&#x5F20;&#x91CF;"><a href="#id25">&#x5F20;&#x91CF;</a></h3>
<p><img src="img/0e81253e59a21c3493d728554e793e80.jpg" alt="../_images/sphx_glr_two_layer_net_numpy_thumb.png"></p>
<p><a href="examples_tensor/two_layer_net_numpy.html#sphx-glr-beginner-examples-tensor-two-layer-net-numpy-py">Warm-up&#xFF1A;numpy</a></p>
<p><img src="img/3ea753e2a569c2d9ad05c6050094ad92.jpg" alt="../_images/sphx_glr_two_layer_net_tensor_thumb.png"></p>
<p><a href="examples_tensor/two_layer_net_tensor.html#sphx-glr-beginner-examples-tensor-two-layer-net-tensor-py">PyTorch&#xFF1A;&#x5F20;&#x91CF;</a></p>
<h3 id="&#x81EA;&#x52A8;&#x5206;&#x7EA7;"><a href="#id26">&#x81EA;&#x52A8;&#x5206;&#x7EA7;</a></h3>
<p><img src="img/d594436be094667a78e5df2a33068666.jpg" alt="../_images/sphx_glr_two_layer_net_autograd_thumb.png"></p>
<p><a href="examples_autograd/two_layer_net_autograd.html#sphx-glr-beginner-examples-autograd-two-layer-net-autograd-py">PyTorch&#xFF1A;&#x5F20;&#x91CF;&#x548C;&#x81EA;&#x5B9A;&#x7B49;&#x7EA7;</a></p>
<p><img src="img/91670ac48d775e53a93477397af73921.jpg" alt="../_images/sphx_glr_two_layer_net_custom_function_thumb.png"></p>
<p><a href="examples_autograd/two_layer_net_custom_function.html#sphx-glr-beginner-examples-autograd-two-layer-net-custom-function-py">PyTorch&#xFF1A;&#x5B9A;&#x4E49;&#x65B0;&#x7684; autograd &#x51FD;&#x6570;</a></p>
<p><img src="img/7e7963967b1dfe2b5920d096cd75502b.jpg" alt="../_images/sphx_glr_tf_two_layer_net_thumb.png"></p>
<p><a href="examples_autograd/tf_two_layer_net.html#sphx-glr-beginner-examples-autograd-tf-two-layer-net-py">TensorFlow&#xFF1A;&#x9759;&#x6001;&#x56FE;</a></p>
<h3 id="citenncite-&#x6A21;&#x5757;"><a href="#id27">&lt;cite&gt;nn&lt;/cite&gt; &#x6A21;&#x5757;</a></h3>
<p><img src="img/2d060e233e6a979b9526a129949c945b.jpg" alt="../_images/sphx_glr_two_layer_net_nn_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_nn.html#sphx-glr-beginner-examples-nn-two-layer-net-nn-py">PyTorch&#xFF1A;nn</a></p>
<p><img src="img/5db16619c1e6eaf064d6315abd3d0565.jpg" alt="../_images/sphx_glr_two_layer_net_optim_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_optim.html#sphx-glr-beginner-examples-nn-two-layer-net-optim-py">PyTorch&#xFF1A;&#x4F18;&#x5316;</a></p>
<p><img src="img/51365bd7bda45f0bb24d1e9b875c3533.jpg" alt="../_images/sphx_glr_two_layer_net_module_thumb.png"></p>
<p><a href="examples_nn/two_layer_net_module.html#sphx-glr-beginner-examples-nn-two-layer-net-module-py">PyTorch&#xFF1A;&#x81EA;&#x5B9A;&#x4E49; nn &#x6A21;&#x5757;</a></p>
<p><img src="img/bf0b252ce2d39ba6da26c16bee984d39.jpg" alt="../_images/sphx_glr_dynamic_net_thumb.png"></p>
<p><a href="examples_nn/dynamic_net.html#sphx-glr-beginner-examples-nn-dynamic-net-py">PyTorch&#xFF1A;&#x63A7;&#x5236;&#x6D41;+&#x6743;&#x91CD;&#x5171;&#x4EAB;</a></p>
<p><hr></p>
<div align="center">
    <p><a href="http://www.apachecn.org" target="_blank"><font face="KaiTi" size="6" color="red">&#x6211;&#x4EEC;&#x4E00;&#x76F4;&#x5728;&#x52AA;&#x529B;</font></a></p>
    <p><a href="https://github.com/apachecn/pytorch-doc-zh/" target="_blank">apachecn/pytorch-doc-zh</a></p>
    <p><iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=watch&amp;count=true&amp;v=2" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <iframe align="middle" src="https://ghbtns.com/github-btn.html?user=apachecn&amp;repo=pytorch-doc-zh&amp;type=fork&amp;count=true" frameborder="0" scrolling="0" width="100px" height="25px"></iframe>
    <a target="_blank" href="shang.qq.com/wpa/qunwpa"><img border="0" src="http://data.apachecn.org/img/logo/ApacheCN-group.png" alt="ML | ApacheCN" title="ML | ApacheCN"></a></p>
</div>
 <div style="text-align:center;margin:0 0 10.5px;">
     <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-3565452474788507" data-ad-slot="2543897000">
     </ins>
     <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?38525fdac4b5d4403900b943d4e7dd91";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-102475051-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-102475051-10');
    </script>
</div>

<p><meta name="google-site-verification" content="pyo9N70ZWyh8JB43bIu633mhxesJ1IcwWCZlM3jUfFo"></p>
<p><iframe src="https://www.bilibili.com/read/cv2710377" style="display:none"></iframe>
<img src="http://t.cn/AiCoDHwb" hidden="hidden"></p>
<div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
    <div id="gitalk-container"></div>
    <script type="text/javascript">
        const gitalk = new Gitalk({
        clientID: '2e62dee5b9896e2eede6',
        clientSecret: 'ca6819a54656af0d87960af15315320f8a628a53',
        repo: 'pytorch-doc-zh',
        owner: 'apachecn',
        admin: ['jiangzhonglian', 'wizardforcel'],
        id: md5(location.pathname),
        distractionFreeMode: false
        })
        gitalk.render('gitalk-container')
    </script>
</div>

<footer class="page-footer"><span class="copyright">Copyright &#xA9; ibooker.org.cn 2019 all right reserved&#xFF0C;&#x7531; ApacheCN &#x56E2;&#x961F;&#x63D0;&#x4F9B;&#x652F;&#x6301;</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A; 
2020-03-04 12:37:36
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="53.html" class="navigation navigation-next navigation-unique" aria-label="Next page: torch.nn 到底是什么？">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"通过示例学习 PyTorch","level":"1.13.1","depth":2,"next":{"title":"torch.nn 到底是什么？","level":"1.13.2","depth":2,"path":"53.md","ref":"53.md","articles":[]},"previous":{"title":"PyTorch 基础知识","level":"1.13","depth":1,"ref":"","articles":[{"title":"通过示例学习 PyTorch","level":"1.13.1","depth":2,"path":"52.md","ref":"52.md","articles":[]},{"title":"torch.nn 到底是什么？","level":"1.13.2","depth":2,"path":"53.md","ref":"53.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["github","github-buttons","-sharing","insert-logo","sharing-plus","back-to-top-button","code","copy-code-button","mathjax","pageview-count","edit-link","emphasize","alerts","auto-scroll-table","popup","hide-element","page-toc-button","tbfed-pagefooter","sitemap","advanced-emoji","expandable-chapters","splitter","search-pro"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy ibooker.org.cn 2019","modify_label":"该文件修订时间： ","modify_format":"YYYY-MM-DD HH:mm:ss"},"emphasize":{},"github":{"url":"https://github.com/apachecn/pytorch-doc-zh"},"splitter":{},"search-pro":{},"search":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"auto-scroll-table":{},"popup":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"hostname":"http://pytorch.apachecn.org"},"page-toc-button":{"maxTocDepth":4,"minTocSize":4},"back-to-top-button":{},"pageview-count":{},"alerts":{},"github-buttons":{"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"}]},"mathjax":{"forceSVG":false,"version":"2.6-latest"},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"sharing":{"qq":false,"all":["qq","douban","facebook","google","linkedin","twitter","weibo","whatsapp"],"douban":false,"facebook":false,"weibo":true,"whatsapp":false,"twitter":false,"line":false,"google":false,"qzone":true},"edit-link":{"label":"编辑本页","base":"https://github.com/apachecn/pytorch-doc-zh/blob/master/docs/1.4"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"insert-logo":{"style":"background: none; max-height: 150px; min-height: 150px","url":"http://data.apachecn.org/img/logo.jpg"},"expandable-chapters":{}},"my_links":{"sidebar":{"Home":"https://www.baidu.com"}},"theme":"default","author":"ApacheCN","my_plugins":["donate","todo","-lunr","-search","expandable-chapters-small","chapter-fold","expandable-chapters","expandable-chapters-small","back-to-top-button","ga","baidu","sitemap","tbfed-pagefooter","advanced-emoji","sectionx","page-treeview","simple-page-toc","ancre-navigation","theme-apachecn@git+https://github.com/apachecn/theme-apachecn#HEAD","pagefooter-apachecn@git+https://github.com/apachecn/gitbook-plugin-pagefooter-apachecn#HEAD"],"my_pluginsConfig":{"page-treeview":{"copyright":"Copyright &#169; aleen42","minHeaderCount":"2","minHeaderDeep":"2"},"ignores":["node_modules"],"simple-page-toc":{"maxDepth":3,"skipFirstH1":true},"page-copyright":{"wisdom":"Designer, Frontend Developer & overall web enthusiast","noPowered":false,"copyright":"Copyright &#169; 你的名字","style":"normal","timeColor":"#666","utcOffset":"8","format":"YYYY-MM-dd hh:mm:ss","signature":"你的签名","copyrightColor":"#666","description":"modified at"},"donate":{"wechat":"微信收款的二维码URL","alipay":"支付宝收款的二维码URL","title":"","button":"赏","alipayText":"支付宝打赏","wechatText":"微信打赏"},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"github-buttons":{"buttons":[{"user":"apachecn","repo":"pytorch-doc-zh","type":"star","count":true,"size":"small"},{"user":"apachecn","width":"160","type":"follow","count":true,"size":"small"}]},"ga":{"token":"UA-102475051-10"},"baidu":{"token":"75439e2cbd22bdd813226000e9dcc12f"},"pagefooter-apachecn":{"copyright":"Copyright &copy ibooker.org.cn 2019","modify_label":"该文件修订时间： ","modify_format":"YYYY-MM-DD HH:mm:ss"}},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Pytorch 中文文档","language":"zh-hans","gitbook":"*","description":"Pytorch 中文文档: 教程和文档"},"file":{"path":"52.md","mtime":"2020-03-04T04:37:36.900Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-03-26T15:06:28.195Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-pageview-count/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-alerts/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

